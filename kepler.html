<!DOCTYPE html>
<html>
  <head>
    <meta charset="us-ascii">
  </head>

  <body>
    <canvas id="canvas" width="640" height="480">
    </canvas>

    <script type="text/javascript">
      var TWO_PI  = 2 * Math.PI,
          RADIANS = Math.PI / 180

      function Body(name) {
        this.name     = name
        this.children = []
      }

      Body.prototype.addChild = function(child) {
        this.children.push(child)
      }

      Body.prototype.draw = function(ctx, t) {
        var i

        ctx.beginPath()
        ctx.arc(0, 0, 0.03125, 0, TWO_PI, true)
        ctx.fill()

        for(i = this.children.length; i--; )
          this.children[i].draw(ctx, t)
      }

      function KeplerBody(
        name,
        eccentricity,
        periapsis,
        inclination,
        longitudeOfAscendingNode,
        argumentOfPerifocus,
        timeOfPeriapsis,
        meanMotion,
        meanAnomaly,
        trueAnomaly,
        semimajor,
        apoapsis,
        period
      ) {
        Body.call(this, name)
        this.periapsis    = periapsis
        this.apoapsis     = apoapsis
        this.semimajor    = semimajor
        this.semiminor    = Math.sqrt(periapsis * apoapsis)
        this.eccentricity = eccentricity
        this.inclination  = inclination * RADIANS
        this.longitude    = longitudeOfAscendingNode * RADIANS
        this.argument     = argumentOfPerifocus * RADIANS
        this.meanAnomaly  = meanAnomaly * RADIANS
        this.meanMotion   = meanMotion * RADIANS
      }

      KeplerBody.prototype.__proto__ = Body.prototype

      KeplerBody.prototype.draw = function(ctx, t) {
        var meanAnomaly = this.meanAnomaly + this.meanMotion * t,
            eccAnomaly  = meanAnomaly

        eccAnomaly = meanAnomaly + this.eccentricity * Math.sin(eccAnomaly)
        eccAnomaly = meanAnomaly + this.eccentricity * Math.sin(eccAnomaly)

        var trueAnomaly = Math.PI - 2 * Math.atan2(
              Math.sqrt(1 - this.eccentricity) * Math.cos(eccAnomaly * 0.5),
              Math.sqrt(1 + this.eccentricity) * Math.sin(eccAnomaly * 0.5)
            )

        ctx.save()
        ctx.rotate(-this.longitude)
        ctx.scale(1, Math.cos(this.inclination))
        ctx.rotate(-this.argument)
        ctx.translate(this.periapsis - this.semimajor, 0)
        ctx.scale(1, this.semiminor / this.semimajor)

        /*
        ctx.beginPath()
        ctx.arc(0, 0, this.semimajor, 0, TWO_PI, true)
        ctx.stroke()
        */

        ctx.rotate(-trueAnomaly)
        ctx.translate(this.semimajor, 0)
        ctx.rotate(trueAnomaly)
        ctx.scale(1, this.semimajor / this.semiminor)
        ctx.rotate(this.argument)
        ctx.scale(1, 1 / Math.cos(this.inclination))
        ctx.rotate(this.longitude)

        Body.prototype.draw.call(this, ctx, t)

        ctx.restore()
      }

      var canvas = document.getElementById("canvas"),
          ctx    = canvas.getContext("2d"),
          sol    = new Body("Sol"),
          start

      sol.addChild(new KeplerBody(
        "Mercury",
         2.056302942128498E-01, 3.074990929205437E-01, 7.005015817746640E+00,
         4.833054124561678E+01, 2.912427858919899E+01,  2451502.287121505011,
         4.092346153579799E+00, 1.747958840172690E+02, 1.764950870217263E+02,
         3.870982121804850E-01, 4.666973314404263E-01, 8.796909804051847E+01
      ))

      sol.addChild(new KeplerBody(
        "Venus",
        6.755786580298123E-03, 7.184402851373205E-01, 3.394589972387207E+00,
        7.667838198116145E+01, 5.518595780861867E+01,  2451513.720261435956,
        1.602148088396929E+00, 5.011477334622277E+01, 5.071202975369376E+01,
        7.233269274872068E-01, 7.282135698370932E-01, 2.246983300777193E+02
      ))

      sol.addChild(new KeplerBody(
        "Earth",
        1.711862907035846E-02, 9.833225165510696E-01, 4.185450226517964E-04,
        1.351086207541469E+02, 3.267003161387815E+02,  2451546.403877350502,
        9.849459659243318E-01, 3.586172566668234E+02, 3.585688860932975E+02,
        1.000448828957874E+00, 1.017575141364678E+00, 3.655022838355956E+02
      ))

      sol.addChild(new KeplerBody(
        "Mars",
        9.331510163651754E-02, 1.381496733245213E+00, 1.849876432291736E+00,
        4.956200626315645E+01, 2.865373825700824E+02,  2451508.062923411839,
        5.240393796687103E-01, 1.935648270200058E+01, 2.333319659853387E+01,
        1.523678993373266E+00, 1.665861253501319E+00, 6.869712734710633E+02
      ))

      sol.addChild(new KeplerBody(
        "Ceres",
        7.837566697457678E-02, 2.549670050504195E+00, 1.058335865297779E+01,
        8.049435901962407E+01, 7.392282742613564E+01,  2451516.163243680727,
        2.141948373214937E-01, 6.176684328649046E+00, 7.246717240568533E+00,
        2.766496021360866E+00, 2.983321992217538E+00, 1.680712777683159E+03
      ))

      sol.addChild(new KeplerBody(
        "Vesta",
        9.002243690231450E-02, 2.148943809018091E+00, 7.133933887603245E+00,
        1.039514574792090E+02, 1.495866294106253E+02,  2451614.870770818554,
        2.715892093873926E-01, 3.410238525941048E+02, 3.372748455329115E+02,
        2.361534939062452E+00, 2.574126069106812E+00, 1.325531308154806E+03
      ))

      sol.addChild(new KeplerBody(
        "Pallas",
        2.296435661959941E-01, 2.135676465810611E+00, 3.484613627101812E+01,
        1.731978001601968E+02, 3.102656523782881E+02,  2451577.969891834073,
        2.135199465215411E-01, 3.529602704587259E+02, 3.484836290785369E+02,
        2.772322488779227E+00, 3.408968511747843E+00, 1.686025150646435E+03
      ))

      sol.addChild(new KeplerBody(
        "Hygeia",
        1.194647813114173E-01, 2.763490530878634E+00, 3.842649982800825E+00,
        2.836631704969067E+02, 3.143682691341799E+02,  2451662.251063035801,
        1.772707978371678E-01, 3.392148105083789E+02, 3.335838652200588E+02,
        3.138421351271348E+00, 3.513352171664062E+00, 2.030791333892896E+03
      ))

      sol.addChild(new KeplerBody(
        "Euphrosyne",
        2.277646536287345E-01, 2.429577276817824E+00, 2.634519016249014E+01,
        3.129177622076273E+01, 6.235091533117577E+01,  2451978.981350477319,
        1.766170035528352E-01, 2.833515142808992E+02, 2.571284841129606E+02,
        3.146161708648030E+00, 3.862746140478237E+00, 2.038308842060643E+03
      ))

      sol.addChild(new KeplerBody(
        "Interamnia",
        1.461352345506762E-01, 2.616224813639418E+00, 1.732332691440113E+01,
        2.806565036601603E+02, 9.451457280866907E+01,  2452183.905824447982,
        1.837702146279859E-01, 2.425881395140818E+02, 2.290055381565955E+02,
        3.063980292315609E+00, 3.511735770991800E+00, 1.958968164284749E+03
      ))

      sol.addChild(new KeplerBody(
        "Davida",
        1.830778709199325E-01, 2.589650379514559E+00, 1.594246848285670E+01,
        1.077642275873270E+02, 3.388845439377725E+02,  2450525.383035807870,
        1.746277915704620E-01, 1.780534587046598E+02, 1.786327358434080E+02,
        3.170008850697621E+00, 3.750367321880685E+00, 2.061527530998641E+03
      ))

      sol.addChild(new KeplerBody(
        "Eunomia",
        1.862037130643558E-01, 2.151467083240580E+00, 1.174734104759529E+01,
        2.935162203671445E+02, 9.696007749174301E+01,  2451077.620284584351,
        2.292849615897351E-01, 1.071631400968843E+02, 1.259011589672746E+02,
        2.643741582235458E+00, 3.136016081230335E+00, 1.570098612241986E+03
      ))

      sol.addChild(new KeplerBody(
        "Juno",
        2.584434357428058E-01, 1.978498799234980E+00, 1.296741968628721E+01,
        1.701726367410528E+02, 2.480316934302164E+02,  2452074.408816703595,
        2.261605297727743E-01, 2.402686215479762E+02, 2.186286873192898E+02,
        2.668034907380008E+00, 3.357571015525036E+00, 1.591789691869291E+03
      ))

      sol.addChild(new KeplerBody(
        "Herculina",
        1.770850959814179E-01, 2.280821462374452E+00, 1.630609464038328E+01,
        1.076625246529934E+02, 7.674743338013862E+01,  2451934.345034935512,
        2.135991545694943E-01, 2.768362297019485E+02, 2.565751634875400E+02,
        2.771637080865107E+00, 3.262452699355761E+00, 1.685399929253345E+03
      ))

      sol.addChild(new KeplerBody(
        "Psyche",
        1.382418390491949E-01, 2.516821072752696E+00, 3.093366419227233E+00,
        1.504660317786795E+02, 2.291189588995035E+02,  2451668.601715288591,
        1.974711561910514E-01, 3.355922263747851E+02, 3.278587607737162E+02,
        2.920565405468058E+00, 3.324309738183420E+00, 1.823051056893107E+03
      ))

      sol.addChild(new KeplerBody(
        "Europa",
        1.009761297624277E-01, 2.785973343289546E+00, 7.467845556830303E+00,
        1.290465133474808E+02, 3.423292737476411E+02,  2451308.984697318636,
        1.806739224727346E-01, 4.264181049901781E+01, 5.124593016424446E+01,
        3.098886954529179E+00, 3.411800565768812E+00, 1.992539903229961E+03
      ))

      sol.addChild(new KeplerBody(
        "Cybele",
        1.036042503720009E-01, 3.078104438974397E+00, 3.547631164669576E+00,
        1.558389915789920E+02, 1.064565471467691E+02,  2452297.245012244210,
        1.548919081607094E-01, 2.434833346491149E+02, 2.334923325621526E+02,
        3.433867731135271E+00, 3.789631023296145E+00, 2.324201465879540E+03
      ))

      sol.addChild(new KeplerBody(
        "Doris",
        7.375069592636554E-02, 2.878551838834422E+00, 6.548881667192425E+00,
        1.839611487217368E+02, 2.604648009833716E+02,  2452246.387597824913,
        1.799015203324987E-01, 2.338193048089029E+02, 2.273641631647255E+02,
        3.107750609014854E+00, 3.336949379195286E+00, 2.001094817512595E+03
      ))

      sol.addChild(new KeplerBody(
        "Egeria",
        8.490106399898487E-02, 2.358237588842647E+00, 1.654143541006942E+01,
        4.332538127900983E+01, 8.050572468040001E+01,  2451771.261596146971,
        2.382455586314615E-01, 3.060941796291174E+02, 2.977398615270104E+02,
        2.577030194295878E+00, 2.795822799749109E+00, 1.511046006766819E+03
      ))

      sol.addChild(new KeplerBody(
        "Iris",
        2.303982831122700E-01, 1.835759444786123E+00, 5.524144818703846E+00,
        2.598742641308049E+02, 1.450800581035616E+02,  2451345.389263205230,
        2.675342931692665E-01, 5.340271737741614E+01, 7.814170220964974E+01,
        2.385336992503000E+00, 2.934914540219876E+00, 1.345621885461358E+03
      ))

      sol.addChild(new KeplerBody(
        "Diotima",
        4.040505060810961E-02, 2.941373839493492E+00, 1.124019900031334E+01,
        6.958375908152195E+01, 2.096282800444803E+02,  2452433.216053846758,
        1.836583447668503E-01, 1.968717097551836E+02, 1.955900902721701E+02,
        3.065224385932298E+00, 3.189074932371104E+00, 1.960161409801505E+03
      ))

      sol.addChild(new KeplerBody(
        "Sylvia",
        7.994419867334075E-02, 3.207973518905905E+00, 1.085888457141809E+01,
        7.334295592511063E+01, 2.674493005897960E+02,  2450878.457644512877,
        1.513837168589918E-01, 1.009036592176001E+02, 1.096976354321030E+02,
        3.486716255992540E+00, 3.765458993079174E+00, 2.378062895201116E+03
      ))

      start = Date.now()
      setInterval(function() {
        var day = (Date.now() - start) * 0.001

        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)
        ctx.save()
        ctx.translate(ctx.canvas.width * 0.5, ctx.canvas.height * 0.5)
        ctx.scale(72, 72)
        sol.draw(ctx, day * 365.25 / 12)
        ctx.restore()
      }, 1000 / 60)
    </script>
  </body>
</html>
